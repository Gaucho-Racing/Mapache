import pytest
from rigby.nodes.gr24.bcm import BCM

def test_generate():
    bcm = BCM()
    bcm.generate()
    for i in range(3):
        assert bcm.imu_accel[i] >= -32768 and bcm.imu_accel[i] <= 32767
        assert bcm.imu_gyro[i] >= -32768 and bcm.imu_gyro[i] <= 32767
        assert bcm.imu_mag[i] >= -32768 and bcm.imu_mag[i] <= 32767

def test_test_generate():
    bcm = BCM()
    bcm.test_generate()
    assert bcm.imu_accel == [-23952, 32199, 0]
    assert bcm.imu_gyro == [32199, 963, -19249]
    assert bcm.imu_mag == [10, 0, -19]

def test_to_bytes():
    bcm = BCM()
    bcm.test_generate()
    assert bcm.to_bytes() == bytearray(b'\x80\x002\x1e\x00\x00\x00\x00\xa2p}\xc7\x00\x00\x00\x00}\xc7\x03\xc3\xb4\xcf\x00\x00\xff\x00\x81)d\x17\x13\xc7\x00\xff\xc7\x02d+\\H\x80\x002\x1e\x00\x00\x00\x00\xa2p}\xc7\x00\x00\x00\x00}\xc7\x03\xc3\xb4\xcf\x00\x00\xff\x00\x81)d\x17\x13\xc7\x00\xff\xc7\x02d+\\H\x80\x002\x1e\x00\x00\x00\x00\xa2p}\xc7\x00\x00\x00\x00}\xc7\x03\xc3\xb4\xcf\x00\x00\xff\x00\x81)d\x17\x13\xc7\x00\xff\xc7\x02d+\\H\x80\x002\x1e\x00\x00\x00\x00\xa2p}\xc7\x00\x00\x00\x00}\xc7\x03\xc3\xb4\xcf\x00\x00\xff\x00\x81)d\x17\x13\xc7\x00\xff\xc7\x02d+\\H\xa2p}\xc7\x00\x00\x00\x00}\xc7\x03\xc3\xb4\xcf\x00\x00\x00\n\x00\x00\xff\xed\x00\x00')